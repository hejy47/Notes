# Formal specification and verification of autonomous robotic systems: A survey

## 摘要

自动机器人系统通常是复杂的，混合的以及安全关键的。该文章描述了自主机器人的形式规范和验证的最新进展，识别和分类了提出的挑战，针对的形式，以及自动机器人的规范和验证的正式方法。

## 介绍

自主机器人的独特挑战及其对复杂软件控制和决策的关键依赖，需要更强形式的验证。越来越多的自主机器人在安全关键场景中的部署加剧了这个问题，并引导我们使用正式的方法来确保机器人系统的正确性，并为其认证提供足够的证据。

## 方法

1. 范围：目标系统(最终)对世界有一些物理影响，而不是纯粹基于软件的系统；不仅涵盖了影响人类的系统，还涵盖了那些可以被人类控制的系统；处理一系列形式属性，尽管主要涉及自主机器人系统的行为；广义上，我们考虑功能性行为，如安全性、安全性、可靠性、效率等；我们将形式限制在形式方法文献中常见的形式——逻辑、代数、自动机、形式模型等。
2. 目的是列举和分析用于自动机器人系统的形式规范和验证的形式方法。回答三个问题
   1. 在形式规范和验证（自主）机器人系统的行为时，有哪些挑战？
   2. 对于问题1，当前使用形式、工具和方法是什么？
   3. 问题2目前的局限性是什么？是否有旨在解决这些问题的开发解决方案？

## 相关工作

1. 七个重点领域：
   1. 物理环境的建模和模拟，以实现更好的安全分析
   2. 机器人系统的正式验证
   3. 按结构正确的控制器
   4. 识别和监控危险情况
   5. 人机交互模型
   6. 适应机器人环境的在线安全监控
   7. 认证证据

## 机器人系统的通用软件工程技术

确定一下类别的非正规和半正规方法：
1. Testing and Simulation测试和仿真
2. Middleware Architectures中间件架构
3. Domain Specific Languages特定领域语言
4. Graphical Notations图形符号
5. MDE/XML

## 自动机器人系统的外部挑战

### 物理环境建模

机器人与其物理环境之间的相互作用会对机器人的行为产生重大影响，因为机器人可能会对不可预见的环境条件做出反应。即使可以获得准确的真实世界模型，机器人也只能部分了解其周围环境，而传感器盲点和传感器之间的干扰导致的传感限制加剧了这种情况。

混合架构通常采用第三种方法；从环境中抽象出来，并假设一个组件能够提供表示关于机器人环境的连续传感器数据的谓词[164，160，70，56，54]。虽然这封装了高级别控制，将其与环境隔离，但是静态已知环境的假设通常是隐含的。

1. 也许用机器人环境的低保真度形式模型也能得到类似的结果。
2. 是一个有用的步骤，它接受了环境不断变化的本质。然而，为了让模型检查器基于某个行为来探索结果，它的概率必须被编码到环境模型中。这仍然留下了不可预见的情况对机器人行为产生有害影响的可能性。类似地，霍夫曼等人[93]使用概率有限状态机(PFSMs)的扩展来形式化无人驾驶飞机及其物理环境。他们使用PRISM来验证他们模型的属性，无人驾驶飞机的任务是在环境中寻找物体，它必须返回到降落位置。
3. 为了解决结合离散计算和连续环境的挑战，机器人系统通常被分成几层[8，70]。在底层，功能层由机器人硬件的控制软件组成。然后，中间层通常利用中间件框架(如ROS [138]或GenoM [72])来提供到硬件组件的接口。上层包含机器人系统的决策组件，捕捉其自主行为。
4. 微分方程模拟了系统的连续行为。使用这些运行时验证技术的故障监控对于捕捉运行系统中的不规则行为很有用，但是它不能确保所有情况下的安全性。
5. Mitsch等人[123]使用为混合系统设计的微分动态逻辑(dL) [133]来描述地面机器人的离散和连续导航行为。

### 信任和认证证据

机器人系统经常部署在安全关键领域，例如核能或航空航天。这些系统需要认证，每个领域通常都有一个特定的认证机构。因此，确保用于开发机器人系统的工程技术能够提供适当的认证证据至关重要。

为一个特定的系统选择一个合适的正式方法并不容易，因为目前没有标准的指导方针来帮助开发人员选择最合适的方法[110]。事实上，这里的主要困难之一是选择一种形式主义，以便在形式主义的表达性和其分析和综合算法的复杂性之间达成良好的折衷[22]。这也给认证机构带来了挑战，他们需要能够确定安全关键型机器人系统的可靠性以及开发过程中采用的正式方法。

与核能和航空航天领域相比，用于家庭或护理环境的机器人没有强有力的认证，但必须证明是安全可靠的。这包括安全和公众对安全的看法；可用性和可靠性的概念；以及机器人不会做任何意想不到、不安全或不友好的事情的感觉[59]。缺乏信任和安全保证会阻碍机器人系统在更广泛的社会中的应用[75]，即使在机器人系统非常有用并有可能提高人类生活质量的地方。

Isabelle/HOL和时态逻辑已经被用来为德国的车辆超车正式化交通规则子集[145]。当我们走向无人驾驶汽车时，一个关键的问题是列举一个机器人需要知道多少关于道路上其他车辆的目标和限制，以便不被认为是任何事故的责任人[123]。在相关的工作中，韦伯斯特等人利用模型检验为使用Gwendolen代理语言和代理Java PathFinder (AJPF)方法的自主无人驾驶飞机系统提供认证证据，作为对Promela和SPIN [172]的改进。

安全箱的组装可以用来为认证机构提供证据。安全案例是一个有证据支持的结构化论证，提供了一个令人信服的、可理解的和有效的案例，证明系统对于给定环境中的给定应用是安全的[51]。自动生成此类文档是一项具有挑战性的任务，因为它需要考虑异构内容，如物理系统设计中的物理公式、维护程序和软件(其本身可能具有异构性质)。丹尼和派[51]描述了一种使用领域理论和自动转换工具[52]为快速无人驾驶飞机系统自动生成此类安全案例的方法，该工具自动生成安全案例片段。

与信任相关的是机器人道德行为的问题。限制机器人或自主系统行为的几种方法集中在伦理和非伦理选择之间的区别上[16，17，36]。

### 总结

外部挑战来自机器人系统的操作和设计环境。挑战是(1)模拟物理环境和(2)提供足够(和适当)的信任和认证证据。有两种方法似乎在文献中占主导地位，它们要么是建模，要么是监测物理环境。例如，时态逻辑已经被用来为环境建模，而模型检查被用来进行验证。指定一个监视器来限制机器人系统在其环境中的安全行为减少了验证负担，因为只需要验证运行时监视器。7然而，全面捕捉所有不安全的情况，以便提前缓解它们是极其困难的。

在这个领域中存在许多导航算法。然而，并不是所有的都可以用于安全关键的场景，因为它们还没有得到验证[132]。这表明在使用当前的形式方法来验证这些算法时存在局限性，并导致具有高计算复杂性的混合方法

## 自动机器人系统的内部挑战

基于代理的方法是提供这些系统所需的自主性的一种流行方式；我们讨论了这种方法给4.1中的正式规范和验证带来的挑战。多机器人系统也是一个活跃的研究领域；4.2.1和4.2.2分别描述了正式指定和验证同构和异构多机器人系统的挑战。

### 基于代理的系统

信仰-欲望-整合(BDI)模型在理性代理的理论基础中占主导地位[78]。基于BDI模型，程序推理系统(PRS)被开发为一个代理架构[77]。这导致了大量的工作[140]，导致这种方法成为文学中自主的主要模式。根据开发的系统，代理可以单独出现，也可以多次出现。

分布式多智能体推理系统(dMARS)是作为PRS的一个实现而构建的，其BDI模型可通过计划来操作[58]。一个dMARS的正式规范已经在Z中开发出来，它为dMARS代理的语义提供了一个正式的基础[58]。这些代理监控世界和他们自己的内部状态。它们主要由计划库、意图功能、事件和计划选择、信念域和目标域组成[58]。

韦伯斯特等人[172，169]使用程序模型检查器验证无人驾驶飞机。飞机由一名BDI特工控制，用格温多伦语言编写[53]，并由AJPF模型检查器验证[55]。已验证的代理被插入飞行模拟器[169]，以可视化已验证的场景。[100，101]中的工作描述了一个GWENDOLEN代理控制一个车队中的无人驾驶汽车。AJPF用于验证汽车加入和离开一个排时的安全性能，以及在排队时保持安全距离。时间属性的验证由Uppaal处理。

他们使用多智能体系统模型检查器(MCMAS) [117]来验证该系统，并说明在这种情况下，MCMAS的性能明显优于SMV。Molnar和Veres还使用MCMAS来验证自主水下航行器[127]。他们使用自然语言编程(sEnglish)，这产生了一个本体，用于表示一个标记的转换系统。然后将其转换为状态流，并用MCMAS进行验证。

霍夫曼等人将智能体的自主行为(基于BDI模型)描述为一个PFSM扩展，用一个权重函数将权重映射到动作上，他们称之为自主概率有限状态机[93]。由于权重函数的加入，一个APFSM是一个离散时间马尔可夫链。他们使用这种代理自治的形式来验证无人驾驶飞机在觅食任务中的属性。

Bozzano等人[31]提出了用于控制航天器的自主推理引擎，它提供计划生成、验证、执行、监控和故障检测。它与地面站通信，执行自主推理，接收传感器数据，并向执行器发送命令。已使用NuSMV实施了一个原型ARE，该原型已用于欧空局漫游车和卫星项目，以提供一种基于模型的机载自主方法。

Podorozhny等人[134]使用Alloy来验证多代理协商，他们的工作提供了一种机制来检查多代理系统的协调和交互属性，以及代理可能操作或共享的复杂数据结构的属性。他们的工作集中在一个系统上，在这个系统中，多个代理一起努力实现一个共同的目标，在这个系统中，代理必须协商以优化实现他们的共同目标。他们已经模拟了代理必须作为有限状态机(FSMs)完成的协商，然后这些协商被转换成合金规范，可以使用合金分析仪进行验证。遇到的主要困难是确保构建的合金模型在检查其属性时保持在可处理的范围内。

### 多机器人系统

存在两大类多机器人系统:群体，其中所有机器人表现出相同的行为；和团队，在那里机器人可以各有各的表现。在这两种情况下，必须在微观层面(单个机器人)和宏观层面(整个系统)考虑系统的行为要求。由于并发交互代理的数量和系统环境的可变性，多机器人系统在确保安全性和活性方面存在困难[7]。

#### 蜂群

一群机器人中的大量机器人会使状态空间爆炸，并阻碍使用传统模型检查方法的验证[108]。另一个问题是可伸缩性:如果你证明了一群n个机器人的一个性质，那么这个性质也适用于n个机器人。

Winfield和Nembrini [179]研究了使用阿尔法算法导航的机器人群的容错性，发现鲁棒性源于群的固有属性:简单的并行机器人，以完全分布式的方式运行，具有高冗余度。特别有趣的是，他们发现机器人的部分故障比机器人的完全故障更有问题。

确定故障是否会在群体中传播，并确定群体完成任务必须保持功能的机器人数量的下限是一个活跃的研究领域[112]。Kouvaros和Lomuscio [112]提出了一种方法，该方法使用时序逻辑和故障注入来确定使用阿尔法算法导航的群中故障机器人与功能机器人的比例。他们指定时间认知属性，然后找到群体不再满足这些属性的阈值。至关重要的是，他们的方法被设计用于在设计时代理数量未知的集群。

机器人群的程序通常是以特别的方式开发的，使用试错法。他们倾向于遵循一种自下而上的方法，包括在将单个机器人组合成一个群体之前对其进行编程，该群体表现出一定的行为[34，118，126]。这种开发过程会降低正式工程方法的有效性；形式方法的应用通常不能保证实现与规范相匹配，因为程序是根据规范手工构建的[118]。温菲尔德等人[178]提出了一种简单的方法，使用PFSM模拟群体的宏观行为。首先，他们估计PFSM的转移概率；然后，他们通过玩家/舞台2中的模拟来验证这些概率。

马尔可夫链已被用来模拟机器人群体成员加入或离开机器人群体的概率[47]。概率是聚集大小的函数，并且基于蟑螂聚集的生物学研究。

Rouff等人比较了四种不同的规范形式(通信顺序进程(CSP)、加权同步CCS (WSCCS)、统一逻辑和X机器)来指定和验证紧急群体行为[148]。他们的结论是，这些形式的混合提供了指定紧急群体行为的最佳方法，因为没有一个单独的方法是足够的。因此，很明显，只有使用多种专门的工具和方法，才能对机器人集群软件，更一般地说，对机器人系统软件达到高度信任[92]。例如，美国国家航空航天局远程代理为每个计划、执行和故障诊断组件使用专门的语言[153]。我们在6.4中探索了使用集成的形式化方法来规范和验证机器人系统。

#### 团队

一个机器人团队类似于一个群体，但包含具有不同能力或行为的机器人。例如，一个搜索和救援机器人团队可能包含一架自主飞机来搜索该地区，一个轮式机器人来携带设备，以及一个带有能够移动障碍物的履带的机器人。机器人能力和行为的异质性增加了它们在验证过程中需要不同正式方法的可能性。因此，将微观层面的核查与宏观层面联系起来是一项挑战。

[106]中的工作提出了一种自动化机器人团队开发的方法，使用了一个没有“下一个”操作符的线性时间逻辑版本。他们对描述机器人团队行为的转换系统进行模型检查，寻找满足LTL-X公式的执行轨迹。这个轨迹然后被映射到每个机器人的通信和控制策略。然后产生一个沟通策略，减少团队必须执行的“停止-等待”同步的次数。

机器人团队通常包括具有不同能力的机器人，这些机器人产生不同的交互模式。[88]中的工作抓住了满足-利他主义模型[154]的一部分，为团队中不同的代理人可以扮演的不同且不断变化的角色提供了一个正式的模型。每个角色都定义了一种交互模式。他们建议将他们的模型用于机器人团队的规范和验证，并最终细化为代码。他们的模型是用一种集成的形式方法(在6.4中有更详细的讨论)来形式化的，这种方法结合了对象-状态图和状态图[86]。

Talamadupula等人[161]描述了一种信念和意图的一阶逻辑形式，可用于允许机器人预测另一个代理的计划。他们探索了一项人机合作任务，其中机器人必须基于相互理解的信念和意图预测人类的计划。代表另一个代理(人类或机器人)的信念和意图的FOL谓词被输入机器人的规划系统，该系统预测另一个代理的计划。扩展迎合了对另一个代理的目标的不完全了解。

### 自适应和可重构系统

1. 确保在危险环境中运行的机器人系统的容错性至关重要，这些环境可能远离任何可能的人类交互。这些系统必须能够自我诊断和重新配置，以适应其要求或操作环境的变化。重新配置有助于保持服务质量或满足功能目标[174]。这对于部署在对人类不利的环境中的机器人系统尤其重要，例如在太空或深海中[76，162]。系统能够解释其推理的理性自主对于安全重构至关重要。因此，对系统的动机和决策建模是当前工作的一个重要方面。理想情况下，这应该以能够对自主决策进行正式验证的方式来完成[

自适应系统在环境驱动的反馈回路中不断改变其行为。文献调查的结果表明，自适应系统的正式建模和验证没有标准工具，30%的调查工具使用模型检查[173]。基于体系结构的自适应系统是一类特定的自适应系统，其中系统根据自身和环境的模型进行推理，并根据一些适应目标进行调整。在这种情况下，反馈回路包括监控、分析、计划和执行组件以及提供知识的运行时模型(MAPE-K) [50]。使用时间自动机和时间计算树逻辑(TCTL)对一系列MAPE-克模板进行了正式验证，以帮助开发。

2. 与适应概念相关的是可重构系统的概念，它感知环境，并决定如何最好地重新配置自己，以适应其要求或物理环境的变化。重新配置对于确保安全关键型机器人系统的容错性至关重要[162]。将形式方法应用于可重构系统时，有两个关键的研究问题:(1)如何指定和分析可重构系统[128]，以及(2)如何比较系统的两种配置[174，128]？

可重构机器的开发是一个领域，在这个领域，已经对这种机器的硬件进行了大量的研究，但是开发能够自动重构系统的软件对整个社区来说是一个挑战[26]。这种系统的开发非常强调将这些系统设计成模块化的，从而使重新配置成为一项更容易实现的工作。

一个研究途径建议提供(半正式和正式)模型，以便在运行时使用[41]。这个议程考虑了诸如自动测试用例生成和正式模型检查等方法。这依赖于这样一个事实，即在系统设计期间未知的许多变量可以在运行时被量化，这有助于控制状态空间爆炸的问题。这样做的好处是在适应性系统适应的同时，为其提供在线保证；这可以提高对安全结果的信任。

3. 去中心化系统会给适应性和可重构性带来一系列挑战。伊夫蒂哈尔和韦恩斯[96]使用交通监控系统作为他们的案例研究，其中一组摄像机监控一段道路上的交通。当检测到交通堵塞时，摄像机以主从架构协作来报告交通信息。这种自适应是在没有中央控制单元的情况下进行管理的，以避免由此造成的通信瓶颈。他们使用TA对这个系统建模，并使用TCTL描述不变量和正确性属性。相关工作利用蒙特卡罗方法，从概率上验证了一个协作代理(自主车辆)系统，该系统实现了基于策略的碰撞避免算法[131]。

### 总结

基于代理的系统绝不是自治的唯一模型，但它们将自治行为的描述封装到一个组件中，并可用于建模与其他参与者和环境的交互。理性的代理人可以解释其推理，这在验证过程中以及在应对为认证机构提供充分证据或获得公众信任的挑战时很有帮助(如3.2所述)。确保代理是可验证的是文献中的一个焦点。

多机器人系统——同质群体和异质团队——给机器人系统带来了有趣的挑战。他们提供弹性架构；但是他们的去中心化给形式验证带来了特殊的挑战。

可重构系统是应对不断变化的环境和任务目标的关键。然而，确保他们以安全的方式重新配置自己是一个挑战，也是文献中的重点。

## 机器人系统的形式

### 时序逻辑

时态逻辑用于指定系统在线性或分支时间上的动态特性，这在文献中有大量描述(表2)。时态逻辑有多种:线性时间时态逻辑(LTL)和计算树逻辑(CTL)处理接下来或最终发生的事件；像概率时态逻辑(PTL)和概率计算树逻辑(PCTL)这样的扩展增加了概率的概念。时态逻辑已经被广泛用于解决我们在3和4中描述的开发可靠的自主机器人系统的挑战。

构建机器人系统时，机器人环境建模是一项关键挑战(3.1)。一种方法[83]使用BA来模拟环境，并通过模型检查来合成运动控制器，以找到满足LTL任务规范的接受路径。BA在运行时用新的环境信息更新，并再次检查以修改运动控制器。

[98]中的工作提出了一种概率方法来模拟BDI机器人代理及其环境。代理可以被捕获为离散时间马尔可夫链(DTMC)或马尔可夫决策过程(MDP)。然后，他们使用PCTL来指定属性，这些属性使用PRISM进行模型检查。他们将这种技术应用于自主地雷探测器，展示了他们的方法如何用于设计时检查和运行时监控(我们将在6.3中详细讨论)。[120]中提出的自治系统运行时安全监控器在CTL中有规定。[57]中的工作通常针对安全机器人，使用信号时序逻辑(STL)捕捉关于现实世界的假设，并将其用于运行时监控。另一个例子，这次针对机器人群[118]，对系统的潜在行为进行建模，并根据安全行为的监督控制理论(SCT)规范对其进行约束。

几种方法使用时态逻辑来提供认证证据或在自主机器人系统中建立公众信任。

让机器人能够处理道德选择是当前的一个公开挑战。文献中的一种方法提出了一种BDI语言ETHAN[55](GWENDELEN的扩展)，这种语言可以推理伦理原则。使用AJPF可以验证，当ETHAN代理选择一个计划时，所有其他适用的计划在道德上是更糟糕的。

另一种流行的方法是综合满足时序逻辑特性的行为模型。例如，在[103]中，运动计划是逐步建立的，它引导机器人到达其目标位置，同时满足在确定性微积分子集中指定的属性。

时态逻辑也被用来验证特定的机器人软件框架。GenoM的现有工具链已经扩展到生成系统的Fiacre模型，然后可以根据LTL属性进行模型检查[74]。另一种方法将机器人操作系统(ROS)节点以及它们之间的通信建模为TA；与乌帕尔的TCTL房产进行核对[85]。他们验证了开源机器人应用程序Kobuki中的队列大小选择没有消息缓冲区溢出。

群体机器人系统表现出宏观和微观两方面的特性。[126]的作者提出了一种新的规范语言，允许对整个群体和单个机器人的行为进行明确的规范。他们的语言将群体的环境捕捉为区域图，使用区域命题描述群体的运动，并使用LTL指定群体的宏观和微观行为(分别)。这些组件被组合起来为机器人群产生分散控制器。

在[69]中提出了一种处理多智能体系统中分散控制的对比技术，这种技术保持了每个机器人智能体的局部规范。每个本地规范都是用LTL编写的，它们的相互可满足性事先没有保证。机器人在物理交汇点交换本地规范，并对模型进行相互满意度检查。然而，这种技术假设机器人代理之间的依赖关系是稀疏的，因此它在机器人群或具有大量依赖关系的团队中可能无法很好地扩展。

概率时态逻辑已被证明在机器人集群建模中是有用的[116]。[108]中的工作对[116]中的概率状态机进行了建模，并在PRISM中检查了PCTL属性的满意度。由于群中的每个机器人都由相同的状态机表征，因此使用计数抽象来减少状态空间；但是，这种抽象只适用于同质群体。

[34]中的工作提出了一种自上而下的群体开发方法，该方法从群体宏观需求的PCTL规范开始。随后，开发了更具体的群模型，包括仿真和现场测试实现。每一步都要对照前面的步骤进行检查，以确保群体的行为符合初始规范。然而，这种方法只关注群体行为的宏观层面，其他方法也考虑微观层面。

### 离散事件系统

Petri网，FSMs——或有限状态自动机(FSA)——是基于离散状态事件指定行为的方法。离散事件系统的形式包括捕捉时间(如时间Petri网)和概率转移(如PFSM或广义随机Petri网(GSPN))。这些形式可用于指定设计阶段的行为，检查死锁自由度等属性；或者用作工具的输入，该工具通常检查它们以另一种形式语言(如时态逻辑)描述的属性。各种时态逻辑和各种FSA之间有着非常密切的联系[165]，因此许多作品将两者结合在一起。

Petri网在机器人系统建模方面有一定的用途。[38]中的工作使用它们来捕获多个反应代理的抽象体系结构，并对它们进行死锁自由分析。在[182]中，齐帕罗等人扩展了Petri网来捕获机器人计划。Petri网的这个扩展是一组目标标记，它是Petri网可达标记的适当子集，代表计划的期望结果。可以执行Petri网计划来找到从初始标记到目标标记的一系列转换。

科斯泰拉和利马[48]使用四层Petri网来建模机器人的任务计划，每一层都描述了不同抽象层次上的不同元素。他们使用标记普通Petri网(MOPN)来指定机器人的环境，以实现更真实的模型。然后，他们使用GSPNs捕捉机器人可以采取的行动、任务计划以及各种机器人一起工作的角色。可以对这些模型进行死锁和资源使用分析。

Uppaal模型检查器使用TA网络来描述输入模型，并根据时态逻辑属性进行检查。[85]中的工作以ROS中间件框架为目标，使用TA捕获ROS节点之间的通信。低级信息(例如队列大小和超时)允许使用Uppaal验证安全性和活性属性。Iftikhar和Weyns [96]使用TA来建模一个分散的交通监控系统，使用TCTL来描述系统不变量和系统自适应行为的正确性。这些属性使用Uppaal进行模型检查。

[119]中的工作基于障碍物位置的概率分布，使用了FSA和环境的高斯模型。这些模型结合在MissionLab中，MissionLab是一个图形化的机器人任务设计器。机器人FSA模型被自动翻译成MissionLab的内部过程代数，机器人模式的过程代数(PARS)，这将在5.3中讨论。

如4.1中所述，霍夫曼等人[93]用一个权重函数扩展了产品行为模型，将权重映射到动作上，他们称之为产品行为模型。由于权重函数的增加，APFSM是一个离散时间马尔可夫链。他们使用这种形式主义来描述自主行为，然后使用PRISM来验证执行觅食任务的无人驾驶飞机的属性，并使用概率模型来捕捉物理环境。马尔可夫链也被用来建立模型来预测机器人群体聚集的可能性[47]。每个机器人由一个马尔可夫链表示，其中加入或离开集合的概率是集合大小的函数，较大的集合是优选的。概率是基于蟑螂聚集的生物学研究结果。[47]的作者发现他们的模型与模拟结果密切相关。

### 过程代数

过程代数方法根据事件和过程的相互作用来定义系统的行为。它们非常适合指定并发系统。过程代数可以捕捉(离散)时间，但它们很少捕捉概率行为。

多智能体系统可以用过程代数有限状态过程(FSP)和π演算结合ADL (πADL)来描述[7]。FSP用于指定系统所需的安全性和活性属性，将其转换为标签转换系统(LTSS)；然后检查代理程序和体系结构(在πADL中描述)，看它们是否满足这些属性。

生物PEPA过程代数已经被用来模拟机器人群体的微观行为[121]。BioPEPA支持使用相同规格的多种不同分析方法。他们描述了一个机器人群执行觅食任务的规范，其中每个被收集的物体需要一个由三个机器人组成的团队，团队投票决定在起点和拾取点之间走一条长路或短路。他们使用随机模拟、统计模型检验和常微分方程给出模型的结果。最有趣的是，这些收集的结果与同一案例研究的现有分析进行了比较；比较表明，Massink等人的方法提供了类似的结果，但从一个单一的规范中实现了更广泛的分析方法。

RoboChart基于CSP [91]，为定时状态机符号[142]提供了一种形式语义。状态机中的每个状态都被建模为进程入口；(在△跃迁期间)；其中进入过程捕获进入该状态时执行的行为，随后依次是(；)通过在该状态下的行为(期间)，这可以被从该状态捕获输出转换的过程(△)中断(转换)。这与2中描述的(非形式)状态图符号ArmarX [167]和rFSM [122]相似。RoboChart由一个基于Eclipse的环境RoboTool [125]支持，它允许以图形方式构建RoboChart图，并可以以上述形式自动转换为CSP。在CSP中，事件是瞬间发生的。RoboChart允许明确的时间预算和截止日期的规范，RoboTool翻译成定时CSP [141]。

CSP模型检查器，故障-偏差细化检查器(FDR) [79]，可以从机器人工具中打开，以实现对机器人工具模型的定时和非定时属性的快速检查。机器人工具自动生成基本断言(检查死锁、活锁、时间锁和不确定性)。这些都是可以编辑的，但是这需要一些CSP的技能和模型的知识，而这是很多软件工程师所没有的。图形化编辑和可视化状态机的能力是将这种符号集成到现有工程过程中的一个关键方面。

计时过程代数CSP+T(它用时间的概念扩展了CSP)也被用来捕捉机器人系统的实时方面。[6]中的工作从统一建模语言(UML)概要文件中的系统描述中导出了正确和完整的CSP+T规范，该概要文件用于开发实时系统。这项工作将系统的UML-RT描述中的每个子系统捕获为一个CSP+T过程，并并行地组合它们。他们在双臂工业机器人上演示了这种方法。然而，相对于UML-RT模型，他们没有解决如何确保他们的CSP+T规范正确性的问题。

正如前面在5.2中提到的，图形机器人任务设计工具MissionLab包含一个进程代数PARS。[119]中的工作使用FSA描述了机器人的行为，并使用高斯模型描述了其环境，但MissionLab会自动将这些转换为PARS，以检查机器人在给定环境中的行为。

### 面向模型的形式主义

面向模型的形式(例如B&Z)将一个系统指定为一组数据和一组操作该数据的操作。它们非常适合捕获复杂的数据结构，但通常只为捕获行为提供有限的特性。

正如4.3中提到的，自适应(或可重构)行为通常是自主机器人系统的关键。Weyns等人描述了一种自适应系统的形式参考模型，称为FORMS [174]，它提供了一个描述任意自适应系统的Z模型。他们建议，这个模型可以与现有的各种工具结合使用，以类型检查适应性，以确保它们是有效的，使用动画师可视化模型，自动生成测试用例，或者将模型转换成其他符号，用于其他类型的分析。该模型提供了一种描述自适应系统的方法，以在系统设计和不同体系结构配置的比较过程中实现关于自适应体系结构的通信。

梁等人[115]使用Jaza animator for Z规范，结合Java调试器，提供了一个运行时监控系统。Z规范描述了系统的行为，这个规范的动画与来自jdb Java调试器的信息进行比较，以检查运行的程序是否实现了Z规范。他们在一个机器人装配系统上演示了这种方法，该系统是为美国宇航局ANTS项目3制造机器人而设计的。将Z动画师与Java调试器相结合的两个优点是，它将监视器和程序代码分开，并且这种方法不需要对被监视的程序进行任何更改。

在[162]中，事件-B规范与概率属性相结合，为机载卫星系统导出可重构体系结构。事件B从B方法发展而来，比其前身[2]更适合于模拟系统的动态行为。这些形式的结合允许在PRISM中检查重新配置模型，以通过细化从系统规范中推导出系统，并对其可靠性和性能进行概率评估。

### 本体论

本体可用于正式指定给定领域的关键概念、属性、关系和公理，从而可以推理它所代表的知识并推断新信息。就自主机器人而言，本体已经被用于描述机器人环境、描述和/或推理任务/动作以及领域知识的重用[135]。从这个意义上说，本体充当了知识的主体，并为特定的领域提供了词汇[84]。IEEE-RAS工作组正在开发一个本体，作为机器人和自动化共享概念的明确和正式的规范，具有逻辑理论的形式[135，84]。这种形式主义的额外好处是能够正式捕捉人机交互的元素。本体作为一种表示机器人系统并对其进行推理的方式已经受到了一些关注，然而，目前对此几乎没有可用的工具支持。

KnowRob是一个用于自主个人机器人助手的知识处理系统[163]。这里，知识使用网络本体语言(OWL)在描述逻辑中表示。他们的系统整合了百科知识、环境模型、基于行动的推理和人类观察。这种方法可以用于ROS。[11]中的工作使用制造环境的本体知识，用OWL表示，以实现无需任何人工干预的重新配置。这项工作使用OWL推理器来决定如何最好地重新配置系统。

### 其他

### 总结

## 机器人的形式化验证方法

### 模型检验

模型检查是验证机器人系统最广泛使用的方法；它已经被用于时态逻辑[59，98]，过程代数[125]和程序[70，67]。可以说，模型检查的流行在某种程度上归功于我们使用时态逻辑(表2)发现的大量出版物，时态逻辑通常用于模型检查方法。此外，我们看到积极选择模型检查的两个主要原因。首先，模型检查器是自动的，这使得它们相对容易使用；其次，在没有正式方法经验的情况下，检查模型中每个状态以查看所需属性是否成立的概念相对容易向涉众解释。

一些模型检查器可以处理定时模型(如Uppaal)或概率模型(如PRISM)。这对处理机器人系统非常有用；安全行为通常需要时间限制，在对机器人的物理环境进行编码时，概率可能会有所帮助。这两个特性都可以提高对结果的信心。程序模型检查器(如AJPF)的输入是程序代码本身，因此检查它的属性包括象征性地执行代码，并根据所需的属性评估每次执行[166]。

模型检查详尽地探索了状态空间，所以人们必须小心要检查的输入模型和属性。状态爆炸可能会削弱使用模型检查的验证工作。韦伯斯特等人[170]报告要求104MB的内存来验证他们的家用辅助机器人模型的每个单独的安全属性。群体机器人系统的模型中也存在类似的状态爆炸问题[108]。各种标准方法可以减轻状态空间爆炸，并保持模型易于处理[45，44]。例如，对于群集，对称约简[15]或者用计数抽象将群集抽象为单个状态机可以有所帮助[169]。

模型检查已被用于建立行为规范(如机器人运动计划)。一种方法是使用模型检查来构建机器人运动计划，该计划满足微积分确定子集[103]中指定的属性。行为规范是逐步建立的，并在每次扩展后进行检查，直到它将机器人移动到其目标并满足所需的属性。类似地，在[83]中，对表示机器人环境的BA进行模型检查，以寻找满足LTL规范的接受路径。接受路径用于合成运动控制器，然后在运行时通过重复的模型检查和合成进行修改。Kloetzer等人[106]使用模型检查来寻找描述满足LTL-X公式的机器人团队行为的过渡系统的轨迹。该轨迹用于为团队中的每个机器人生成通信和控制策略。

显然，模型检查是一种灵活的方法:它被用于各种形式，可以描述并发、定时和概率系统；并已用于各种机器人系统的验证工作。对计算能力和内存的访问越来越多，加上减少状态空间的巧妙方法，保持了模型检查在文献中的流行。需要为特定的模型检查器精心制作模型，这增加了建模时间，降低了工具之间模型的可移植性。然而，验证机器人系统的模型检验方法的自动化和相对简单意味着它仍然是研究的焦点。

### 理论证明

定理证明提供了产生软件系统正确性的形式证明的好处。这些形式证明可用于为自主机器人系统的认证提供可靠的证据。这里一个值得注意的例子是使用伊莎贝尔/HOL和时态逻辑来形式化德国车辆超车的交通规则子集[145]。最近，机器人艺术符号及其相关工具集也利用伊莎贝尔/HOL来验证机器人系统[73]。

这个领域的其他工作包括[123]，它使用混合系统逻辑D1[133]来描述机器人漫游车的离散和连续导航行为。然后，他们使用混合定理证明器KeYmaera、Mitsch等人来验证机器人不会与静止或移动的障碍物碰撞，并且与障碍物保持足够的距离。Mitsch等人【124】更新了这项工作，验证了一个不太安全的属性，允许不完美的传感器；添加活性证明，以保证进度；以及从已验证的模型中自动合成运行时监视器，以减轻由现实差距引起的问题。

在[88]中，OZS(Object-Z和Statecharts [86]的组合)被用来捕捉多机器人系统中的代理可以扮演的动态角色，这些角色定义了机器人的交互模式。OZS有一个操作语义，STeP定理证明用于验证他们模型的安全性和活性。

虽然有效，但从我们的分析中可以清楚地看出，这类方法在文献中并没有得到太多的关注。我们认为这是一个可用性问题，因为这些工具通常比其他方法更难掌握。

### 运行时监控

1. 运行时监视器可以用来回避验证机器人系统(必要的)复杂模型的问题。不是指定和验证整个系统，而是提取系统必须展示的属性，并将其指定为系统的监视器。因为显示器比系统简单，往往更容易验证。另一个优点是运行时监视器可以减轻现实差距(模型和现实世界之间)的问题，尤其是当用于补充离线验证时。鉴于机器人系统是自然的网络物理系统，因此故障可能会产生安全后果，在运行时监控系统的行为可能是安全操作的关键[155]。

监视器消耗来自系统的事件，并将它们与预期行为进行比较。如果系统的事件不同于预期，那么它可以调用缓解活动，包括记录、向用户标记或触发行为来补救这种情况。运行时监控不能预先保证所有的系统行为，它已经在运行时验证的文献中受到关注，该文献集合了模型检查和流处理技术[146]。例子包括[65，96，95]，国际运行时验证会议从2006年开始运行。

Aniculaesei等人[14]使用运行时监视器来补充设计时形式方法。构建运行时监视器是为了检查在程序执行期间设计时的假设是否成立。为了增加设计时的可信度，他们还使用在TCTL具有安全属性的TA来指定系统及其物理环境。Ferrando等人【68】开发了运行时验证，以识别异常的环境相互作用，并因此强调先前在自主机器人系统上进行的正式验证(带有一些环境假设)何时无效。

凯恩等人[102]提出了一种自主研究飞行器的运行时间监控器。这些监视器是用αVSL安全规范语言编写的，其语义是通过时间戳跟踪给出的。(特别是，它使用未来的、命题的度量时态逻辑(MTL)。)他们的算法EgMon使用MAUDE重写引擎来减少输入公式。他们用混合监控算法HMon扩展了EgMon，该算法首先执行保守检查，然后在剩余时间允许的情况下执行尽可能多的紧急检查。

2. 通常，机器人系统是分布式的；要么是因为软件架构(如ROS)，要么是因为它是一个多机器人系统(如机器人群)。对于这样的系统，鲍尔和法尔科内[21]描述了一种将系统的宏观行为的LTL规范分发给一组微观行为监视器的方法。他们的方法不假设任何中央信息收集，并确保监视器之间的通信最少，但足以允许监视器工作。

3. 机器人系统本质上是网络物理的，结合了离散和连续的部分。在[155]中讨论了这一点对运行时监控的影响，其中描述了一种在不离散化的情况下模拟网络物理系统混合性质的方法。他们使用概率混合自动机(PHA)来捕捉系统的离散和连续元素。他们用电子控制列车制动系统来说明他们的方法。[124]采用了类似的混合逻辑方法，他们使用dL指定机器人漫游车的安全属性，然后根据这些经过验证的模型自动合成运行时监视器。

### 集成形式化方法

集成形式方法(iFM)是指多种形式方法的集成，或者一种具有半正式或非正式方法的形式方法，它们相辅相成。尽管仍然很困难，但iFM可以同时捕捉系统的几个维度(例如状态和动态行为)，以便于分析。在我们以前的工作中，我们认为机器人系统为解决集成的挑战提供了动力；此外，因为机器人系统本质上是混合的，所以它们需要iFM [66]。这种需求的一个早期例子是一项研究，该研究得出结论，没有一种形式适合应用于机器人游泳，4种形式的组合将是最佳方法[89]。

4中提出的挑战通常最好使用iFM来解决。然而，我们的文献搜索没有发现将iFM应用于机器人的通用方法。在这里，我们讨论一些著名的定制例子。为了实现基于细化的开发和概率检查，[162]使用事件B和概率语言来检查机载卫星系统的可重构架构。[7]中的工作结合了FSP和πADL来捕获多智能体机器人系统的安全性和活性属性。将相关安全性和活性属性的FSP规范转换为LTSs，然后检查代理程序和体系结构(在πADL中描述)以查看它们是否满足所需的属性。

这些定制的例子集成了两种或更多种正式的方法，以获得一种具有综合优势的方法。也有将形式主义与非形式符号相结合的例子。例如，一种从实时UML概要文件UML-RT [6]中导出正式规范的方法，该方法将UML-RT子系统捕获为定时CSP派生CSP+T中的流程。这也为UML-RT提供了CSP+T中的语义。

### 可验证机器人软件框架

1. 行为交互优先(BIP)框架[19，18]是一个基于组件设计的工具集，它的符号基于有限状态机，用于实时软件建模。使用的基本(原子)组件是一个状态转换系统，标记为C/C++函数。这些组件组合在一起形成更大的组件，可以使用D-Finder工具验证模型[24]。在[1]中，Abdellatif等人将BIP框架与GenoM机器人软件架构相结合，提供了一种技术，可以根据所需行为的BIP模型合成机器人控制软件。这使得在GenoM中生成机器人软件成为可能，这种软件通过构造是正确的。Abdellatif等人展示了轮式漫游机器人的软件生成，使用故障注入来测试BIP规范中的约束是否由生成的软件实施。

2. Averest框架提供了用于验证用石英语言编写的同步程序的时间属性的工具[137]。这些石英程序被翻译成Averest交换格式(AIF)，然后使用绿柱石模型检查器或其他有接口的第三方工具(如SMV)对照LTL规范进行验证。此外，该框架有一个名为Topaz的代码生成工具，可以输出Verilog、VHDL和C代码。

3. 陈等人提出了一个机器人团队控制和通信策略自动综合的计算框架，该框架使用以正则表达式形式编写的任务规范[39，40]。他们的目标是从用于创建FSA的正则表达式中生成可证明正确的个人控制和通信策略。他们的方法是用一个机器人城市般的环境(规则)来说明的，在这个环境中，自动驾驶汽车必须导航并避免碰撞。他们的技术受到LTL模型检测技术的启发，为了获得工具支持，他们使用了JFLAP和MatLab [40]。

4. 金等人[105]使用埃斯特尔框架来验证家庭服务机器人的停止行为。该框架提供了使用模型检查来指定和验证机器人系统的工具。埃斯特尔也可以被翻译成一个相关的C或C++程序，埃斯特尔程序的语义是根据它描述的有限状态机给出的。为了能够检查系统的时序逻辑属性，作者在埃斯特尔将它们翻译成观察者。

### 总结

本节讨论了文献中的正式验证方法，总结在表4中。最流行的方法是模型检查，这反映在机器人系统规范的时序逻辑和离散事件系统的优势(5)。我们推测，模型检查在文献中的流行可能是因为它在没有正式方法背景的情况下更容易理解和信任，例如，它在概念上类似于穷举测试。

## 讨论

具体来说，这些是机器人物理环境的建模、机器人系统的正式验证、按构造校正控制器综合，以及能够提供认证证据。最后这一点尤其重要，也是当前文献中的一个重点。最后，我们调查的工作基本上属于验证应用程序内部正确性的范畴；自主系统自动验证的三大挑战之一。

1. 问题1：被问及在正式指定和验证(自主)机器人系统时有什么挑战。我们确定了两种类型的挑战:机器人系统外部的挑战，在3中讨论过；和19机器人系统内部的那些，在4中讨论。我们确定的外部挑战是:模拟机器人系统的外部环境，并为公众信任和认证提供足够的证据。我们确定的内部挑战是使用:基于代理、多机器人和自适应/可重构系统。可重构性是在危险环境中安全部署机器人的关键，为了确保可重构自主系统的安全，需要做更多的工作。因此，我们看到了机器人系统对外部环境变化的反应与可重构系统之间的明显联系。

同样，能够解释其推理的基于理性主体的系统为公众信任或认证机构提供了一个很好的证据途径。这是因为它们实现了信任和认证所需的关键透明度。要求透明的一个例子是[177]提出的道德黑盒，它记录传感器输入和系统的内部状态。理性的代理可以根据输入和内部状态信息为其选择提供理由。

2. 问题2：被问及目前有哪些正式的方法用于应对通过回答RQ1确定的挑战。我们的分析，在5和6中提出，表明时间逻辑，离散事件系统和模型检验器是过去十年文献中最突出的形式和方法。我们推测，这是因为时态逻辑和离散事件系统允许抽象规范，这在开发过程的早期是有用的，并且因为模型检查作为一种方法通常很容易向没有使用正式方法经验的涉众解释。

3. 问题3：被问及在对RQ2的回答中确定的最佳实践形式和验证方法的局限性。一个限制似乎是机器人系统开发中采用正式方法的阻力[118]。人们认为，应用正式的方法是工程过程中一个复杂的附加步骤，它会延长开发过程，同时不会增加最终产品的价值。缺乏适当的工具也常常阻碍正式方法的应用。这是一个由来已久的观点，例如[107]的作者在[118]之前19年发表的文章。然而，也有正式方法的工业应用的显著例子，如[181]中所研究的。

同一形式主义的各种工具(如表3所示)也指出了一个问题:形式主义之间缺乏互操作性。通常，相似组件的型号或规格是不兼容的，并且被锁定在特定的工具中。这表明，在不同形式之间进行翻译、关联或整合的通用框架，将有助于平滑形式或工具之间的转换。此外，这将满足日益增长的使用一组异构形式捕捉复杂系统行为的需求，每种形式都适合于被建模的组件或感兴趣的属性。这是机器人系统形式化方法中的一个公开问题。

机器人系统的形式化方法面临的另一个限制是形式化最后一个环节，即形式化模型和程序代码之间的步骤。我们很少发现机器人技术的正式方法的例子，这些方法也从规范中产生可运行的程序代码，在这些例子中，通常不清楚代码是如何与原始规范模型相关联的。这样的最后一个链接翻译步骤需要一个正式的基础来确保模型由代码来表示。缺乏对这一限制的清晰认识指向了另一个限制:缺乏开放的模型、代码和现实案例研究的共享，这些都不是为特定的形式主义而调整的。

现场测试和模拟实验都是机器人系统开发的有用工具；但是正式的验证是至关重要的，尤其是在开发的早期阶段，控制软件的现场测试是不可行的(或危险的)。对形式方法的组合或集成的集中研究努力应该改进它们在机器人系统开发中的使用，因为没有一种形式主义能够充分捕捉到机器人系统的所有方面都像预期的那样运行。确保开发人员可以使用这些工具，并在集成开发环境中提供类似的功能，也可以通过简化它们的使用来提高它们的使用率。这个领域的工作可以导致一个集成的验证环境，允许使用不同的形式，使用相同的开发人员前端，将它们连接到各自的工具，并提供有用的类似集成开发环境的支持。

本文分析了当前最先进的文献，特别是自动机器人系统的形式规范和验证。为此，本调查为确定该领域的未来方向提供了基础。